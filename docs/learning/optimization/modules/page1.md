# 前端性能优化

### 一、加载优化

1. **预加载（Preload）**
   - 使用 `<link rel="preload">` 提前加载关键资源，如字体、CSS、JS等。
   - 示例：`<link rel="preload" href="/styles.css" as="style">`

2. **懒加载（Lazy Load）**
   - 对图片、视频等大文件采用懒加载技术，仅当用户滚动到视口内时才加载。
   - 示例：使用 `loading="lazy"` 属性。

3. **延迟加载（Defer/Async Script Loading）**
   - 通过 `defer` 或 `async` 加载脚本，避免阻塞页面渲染。
   - `defer` 按顺序执行脚本，而 `async` 不保证顺序但异步加载。

4. **资源合并**
   - 将多个小文件合并为一个，减少HTTP请求次数。
   - 注意平衡文件大小与浏览器缓存效率。

5. **资源压缩**
   - 使用工具压缩HTML、CSS、JavaScript代码，去除不必要的空格和注释。

6. **CDN**
   - 使用内容分发网络(CDN)加速静态资源的访问速度。

7. **HTTP2/3**
   - 升级到HTTP/2或HTTP/3以利用多路复用、头部压缩等功能提升性能。

8. **强缓存/协商缓存**
   - 合理设置 `Cache-Control` 和 `ETag` 头部来控制缓存行为。

9. **字体资源使用font-display：swap**
   - 设置 `font-display: swap;` 确保文本在自定义字体加载前可见。

### 二、构建优化

1. **Tree-shaking**
   - 利用Webpack等打包工具移除未使用的代码部分，减小最终包大小。

2. **打包分块：第三方和业务分离**
   - 分离第三方库与业务逻辑代码，利用长期缓存机制提高加载效率。

3. **代码分割**
   - 根据路由或组件动态加载模块，减少初始加载时间。

4. **按需加载**
   - 实现功能或页面级别的懒加载，只加载当前需要的部分。

### 三、渲染优化

1. **骨架屏**
   - 在内容加载前显示占位符，改善用户体验。

2. **虚拟滚动加载**
   - 针对长列表，仅渲染视口内的元素，减少DOM操作成本。

3. **SSR (Server Side Rendering)**
   - 在服务器端完成页面首次渲染，加快首屏加载速度。

4. **减少重绘和回流**
   - 批量修改样式，尽量使用类名代替直接操作样式属性。

5. **内存泄漏减少**
   - 定期检查并清理不再使用的变量和事件监听器。

6. **编写复用函数和组件**
   - 提高代码复用性，降低维护成本。

7. **内连CSS**
   - 对于关键路径上的CSS，可以考虑内联至HTML中以减少额外请求。

8. **动画使用transform和opacity GPU加速动画**
   - 使用 `transform` 和 `opacity` 来创建平滑的GPU加速动画，避免触发布局重排。

### 四、图像优化

1. **格式WEBP**
   - 转换图像格式为WebP，相比JPEG/PNG有更高的压缩率。

2. **压缩**
   - 使用工具压缩图片，保持视觉质量的同时减小文件大小。

3. **懒加载+占位图**
   - 结合懒加载技术和占位图，确保图像加载流畅且高效。

### 五、监控分析

1. **前端埋点和上报**
   - 收集用户行为数据，用于后续分析和优化决策。

2. **性能面包分析和追踪**
   - 使用Lighthouse等工具定期评估网站性能，并跟踪改进效果。

3. **持续优化**
   - 基于监控数据不断调整和优化网站性能。

